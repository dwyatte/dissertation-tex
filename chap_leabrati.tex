\documentclass[dwyatte_dissertation.tex]{subfiles} 
\begin{document}

\sloppy

\chapter{The LeabraTI framework: Spatiotemporal prediction with thalamocortical rhythms}
\label{chap:leabrati}

% Plus phase
% + Thalamic burst
% + Cortical amplification of Thalamocortical signals, causes ignition of microcolumn
%   through 2/3->5 and 5b burst to 6
% 	+ Find refs on this -- gating by synchrony. but synchrony is due to inhibition? 
%   + Possibly sensory + intrinsic bursting combo causes gating
%
% Minus phase
% + Next 100-len(bursting) ms characterized by endogenously (L6) driven inputs
% + Thalamus doesn't burst, information already gated down in column, so it becomes primary driver
%   + Should sensory still be let in through feedforward path? Or does it *never* get past L4?
%
% BeierleinFallRinzelEtAl02 - burst > 40 Hz 
% WangSpencerFellousEtAl10 - sync
% FeldmeyerLubkeSilverEtAl02 - sync
% TiesingaFellousSejnowski08 - sync

% TODO
% * Nesting of gamma within alpha, and actually is the ``duty cycle'' -- need to reread Spaak, Jensen papers
% * analogies about carrier signals/duty cycles?

\section{Introduction}
This chapter describes the LeabraTI (Temporal Integration) framework, which is a mechanistic description and general model of how prediction and temporal integration works in the brain. It is closely related to the Simple Recurrent Network (SRN) \cite{Elman90,Servan-SchreiberCleeremansMcClelland91}  a neural network architecture that explicitly represents temporally lagged information in discrete ``context'' units whose activity gets integrated with more current information to predict what happens in the next time step (Figure \ref{fig:srn_circuit}a). This method of copying a contextual representation from an intermediate representation at discrete intervals was originally shown to be a robust way to leverage error-driven learning to represent latent temporal structure in auditory streams and artificial grammars. More generally, the SRN's explicit representation of temporally lagged context can capture the latent structure of any stimulus that varies systematically over time, making it a good basis for a generic prediction and temporal integration mechanism.

LeabraTI differs in several key ways from the classical SRN architecture, primarily in the way context is represented and used in predictive processing. These differences are due to biological constraints imposed by the microcircuitry of the neocortex, and thus form a number of testable predictions that can be used to evaluate the validity of the LeabraTI framework. The central prediction of LeabraTI is that temporally lagged context is represented by deep (Layer 6) neurons, which is possible in part to the bifurcation of intra-areal and inter-areal processing streams. As neural processing is a continuous operation, LeabraTI requires a regular interval over which to integrate deep context and make predictions, which is approximately every 100 ms. Predictions are made by driving superficial (Layers 2 and 3) neurons with the state of deep neurons through the intra-areal pathway, which is interleaved with standard peripheral sensory inputs over a total period that is also 100 ms. The strong 100 ms dependency in LeabraTI corresponds to the brain's alpha rhythm, which has been studied extensively using scalp EEG (\nopcite{MathewsonGrattonFabianiEtAl09,BuschDuboisVanrullen09,GouldRushworthNobre11,RohenkohlNobre11}; \abbrevnopcite{MathewsonPrudhommeFabianiEtAl12,BelyusarSnyderFreyEtAl13}; \nopcite{VanRullenDubois11}). 

\textbf{TODO: Foreshadow structure of chapter...}

% srn/microcircuit fig
\begin{figure}[h!]
\begin{center}
\begin{tabular}{ll}
\textbf{A} & \textbf{B} \\
\includegraphics[width=85mm]{figs/chap_leabrati/srn_scm.png} &
\includegraphics[width=75mm]{figs/chap_leabrati/microcircuit_horiz.pdf} \\
\end{tabular}
\end{center}
\caption{The Simple Recurrent Network (SRN) and microcircuitry of the neocortex}{\textbf{A}: The SRN represents temporal information explicitly using discrete context units that are updated once per time step. Context is integrated with more current inputs to predict information at the subsequent time step. Reproduced from \protect\incite{Servan-SchreiberCleeremansMcClelland91}. \textbf{B}: The neocortex is laminated with canonical circuitry between neurons across layers and between areas. Principal intra-areal connections are shown in black with inter-areal feedforward connections in purple and feedback connections in green.}
\label{fig:srn_circuit}
\end{figure}

\section{LeabraTI biological details}

\subsection{Laminar structure and microcircuitry of the neocortex}
A salient feature of the brain, and potential clue in realizing how an SRN-like computation might be carried out in biological neural circuits, is the laminar structure prevalent across the neocortex (Figure \ref{fig:srn_circuit}b). Incoming information from the sensory periphery is transmitted through the thalamus and targets Layer 4 neurons in the primary sensory cortices (e.g., V1). From there, Layer 4 neurons propagate spikes to superficial neurons (Layers 2 and 3) which in turn target Layer 4 neurons of higher-level cortices, forming the prominent corticocortical feedforward pathways that subserve visual and auditory recognition \cite{FellemanVanEssen91}. Corticocortical feedback originates in superficial layers or Layer 6 of the higher-level cortex and generally terminates on superficial neurons of the lower-level cortex \cite{RocklandPandya79}. In addition to these inter-areal pathways, there exists a canonical microcircuit of the form Layer 4 $\rightarrow$ Layer 2/3 $\rightarrow$ Layer 5 $\rightarrow$ Layer 6 that routes spike propagation through the local neuronal structure \cite{DouglasMartin04,ThomsonLamy07,DacostaMartin10}. This microcircuit forms the core computational unit of LeabraTI, as will be described in this and the following sections.

The importance of the local microcircuit was first suggested by Vernon Mountcastle in his proposal regarding the gross columnar organization of the neocortex \cite[see][for a comprehensive review]{Mountcastle97}. Mountcastle's proposal states that microcolumns composed of around 80-100 neurons extending vertically through all six lamina with canonical circuitry form the core repeating structure of the neocortex. Neurons within a single micrcolumnnar circuit possess nearly identical receptive field tunings across lamina while neurons in neighboring microcolumns (radial separation greater than 600 \SI{}{\micro\meter}) possess very different receptive field tunings but contribute to the higher-order macrocolumn (i.e., hypercolumn) structure \cite{HubelWiesel77,Jones00}. Microcolumns have been identified in a variety of neural systems with this electrophysiological mapping and are also prominently visible under Nissl staining. Despite this evidence for their structural existence, any function of the microcolumn aside from an organizing principle remains debated \cite{BuxhoevedenCasanova02,HortonAdams05}.

LeabraTI provides a computational role for the microcolumn, by mapping an SRN-like computation onto their Layer 4 $\rightarrow$ Layer 2/3 $\rightarrow$ Layer 5 $\rightarrow$ Layer 6 circuit (Figure \ref{fig:srn_circuit}). In this mapping, superficial neurons continuously integrate feedforward and feedback inter-areal synapses to process current information. Layer 2/3 $\rightarrow$ Layer 5 $\rightarrow$ Layer 6 provides an intra-areal pathway for explicitly representing temporal context in Layer 6 neurons, which are relatively isolated from nonlocal inputs. There is also appropriate circuitry for recirculating this context through the local microcolumn via Layer 4 to drive the learning of temporal associations. This basic idea provides a concise explanation for the strong degree of isotuning throughout a single microcolumn, as Layer 6 neurons need to represent the same overall information as superficial neurons except at a delayed interval.

\subsection{Layer 5 rhythmic bursting and contextual gating}
The laminocolumnar organization of the neocortex provides the dual pathways necessary for continuous information processing and the SRN's explicit temporal context representation. The Layer 4 $\rightarrow$ Layer 2/3 $\rightarrow$ Layer 5 $\rightarrow$ Layer 6 microcircuit only contains four synapses plus the transthalamic re-entrant synapses. Intracolumnar monosynaptic latencies for regular spiking neurons are on the order of 5 ms or faster \cite{Armstrong-JamesFoxDas-Gupta92,LumerEdelmanTononi97} and thus this relatively small amount of tissue, if driven with constant input, would circulate spikes at a rate too fast to perform enough temporal integration to make useful predictions. Several studies have noted that a subset of Layer 5 neurons exhibit intrinsic bursting at $\sim$10 Hz when over threshold (\nopcite{ConnorsGutnickPrince82,SilvaAmitaiConnors91}; \abbrevnopcite{FranceschettiGuatteoPanzicaEtAl95}). This rhythmic busting might implement a gating mechanism for updating Layer 6 context information at a regular 100 ms interval.

More specifically, Layer 5 neurons can be roughly divided into 5a and 5b subtypes \cite{ThomsonLamy07}. Layer 5a neurons have relatively small cell bodies and exhibit regular spiking depolarization responses. They collect input from other Layer 5a neurons both within and across columns \cite{SchubertKotterStaiger07} and pass it to 5b neurons and thus, likely play a simple information integration role. Layer 5b neurons, in contrast, have larger cell bodies and exhibit the aforementioned 10 Hz intrinsic bursting response profile. In the context of LeabraTI, the interpretation of this data is that the 5a neurons serve to integrate information from multiple Layer 2/3 neurons, with the 5b neurons gating context to Layer 6 neurons with each 10 Hz burst.

Layer 6 corticothalamic neurons receive strong inputs from Layer 5b neurons and send axons toward the thalamus completing the microcircuit within the local column and allowing the temporally lagged Layer 6 responses to integrate with more current Layer 4 inputs. Information is relayed from the thalamus back up to layer 4 in a focal one-to-one manner that maintains microcolumnar separation \cite{ShermanGuillery06,Thomson10}, which could allow temporal associations to be formed by local Hebbian learning mechanisms that track high probability co-occurences across past and present events \cite{Foldiak91}.

\subsection{Thalamic gating and sensory prediction}
Both the SRN computation and the Leabra algorithm \cite{OReillyMunakata00,OReillyMunakataFrankEtAl12} that are used to implement the LeabraTI framework are predicated on using powerful error-driven learning mechanisms (in addition to more standard Hebbian learning mechanisms) to represent the mapping between sensory inputs and outputs. In the context of temporal integration, error-driven learning would allow computation of error signals based on the difference between what is predicted to happen at a given moment (given the previous moments context as an input) and what actually happens. However, this computation requires that both the prediction and the actual sensation are represented by the same neural tissue so that an error signal can be computed, which is not possible if the sensory periphery is continuously transmitting incoming inputs. 

To resolve this issue, the LeabraTI framework posits that predictions about sensory events and the sensory events themselves are temporally interleaved through the same population of neurons in an alternating manner. This requires a mechanism to periodically downmodulate or even block the transmission of inputs from the sensory periphery. A subset of cells in the thalamus exhibit $\sim$10 Hz intrinsic bursting properties similar to that of Layer 5 neurons (\nopcite{LopesdaSilva91}; \abbrevnopcite{HughesLorinczCopeEtAl04}; \nopcite{LorinczCrunelliHughes08}; \nopcite{LorinczKekesiJuhaszEtAl09}), and thus perhaps perform a similar gating computation of sensory inputs into cortical circuits. In the context of LeabraTI, these bursting neurons might shift the balance of inputs to Layer 4 and superficial neurons between endogenous inputs local to the microcolumn representing predictions and quick bursts of actual sensory information. 

More specifically, during the non-bursting intervals of thalamic intrinsically bursting neurons' response, environmental inputs are downmodulated due to the relative quiescence and Layer 6 neurons provide the dominant driving potential to the microcolumn. Layer 6 corticothalamic neurons exhibit a strong regular spiking depolarization response with facilitating short-term dynamics \cite{Thomson10} unlike all other pyramidal neurons, which exhibit depressing dynamics. This might suggest a specialized function for Layer 6 neurons, which in the context of LeabraTI is to drive a sustained prediction about upcoming sensory information. These layer corticothalamic neurons also sustain their drive through reciprocal projections with the thalamic relay cells that they project to. In addition to the Layer 6 $\rightarrow$ Layer 4 transthalamic pathway, Layer 6 neurons also project directly to Layer 4. While these projections are relatively weak \cite{HirschMartinez06b}, they do activate a metabotropic glutamate receptor (mGluR) that produces sustained depolarization similar to Layer 6 corticothalamic neurons \cite{LeeSherman09} -Ñ these direct ascending synapses are another possible route for sustained context information to drive Layer 4 neurons. 

The burst response of thalamic intrinsic bursting neurons synchronized with the burst response of Layer 5b neurons destabilizes the Layer 6 sustained prediction through biased competition. This provides a snapshot of the current state of the sensory periphery as well as an opportunity to integrate the state of current sensory event into a prediction about what will happen during the next moment. At this time, standard error-driven learning mechanisms that compute short timescale firing rate differences \cite{OReillyMunakata00,OReillyMunakataFrankEtAl12} compute an error signal between the previous moment's prediction and this current sensory event to minimize overall prediction error.

\section{Summary of LeabraTI computation}
The overall computation of LeabraTI is shown in Figure \ref{fig:leabrati_comp} and summarized here. Standard Leabra learning operates across two phases: a \textit{minus} phase that represents the system's expectation for a given input and a \textit{plus} phase, representing observation of the outcome. Generally, feedforward sensory inputs provide the dominant drive during the minus phase while the plus phase is driven by a combination of feedforward sensory inputs and the target outcome, conveyed via feedback projections. Leabra networks typically only model at the level of superficial (Layers 2 and 3) neurons, since they provide the principal feedforward and feedback projections necessary for error-driven learning.

% leabrati computation
\begin{figure}[h!]
\begin{center}
\includegraphics[width=160mm]{figs/chap_leabrati/leabrati_comp_new.pdf}
\end{center}
\caption{The LeabraTI computation}{}
\label{fig:leabrati_comp}
\end{figure}

In LeabraTI, deep Layer 6 neurons provide the dominant input to superficial Layer 2 and 3 neurons during the minus phase, relayed via Layer 4 transthalamic and direct ascending projections. This represents a sensory prediction about what is about to happen during the subsequent plus phase, using temporally lagged context from the previous plus phase. To be computationally useful, the prediction needs to last at least 50 ms in order to allow contributions from both the feedforward drive and relatively weaker (and thus, slower acting) feedback from higher-order cortical areas. The short-term facilitating dynamics unique to Layer 6 corticothalamic neurons or mGluR activation from the direct ascending projections provide the sustained spiking response during the minus phase. Reciprocal thalamocortical synapses back to Layer 6 might also assist in maintaining minus phase input drive. During this period, input from the sensory periphery is extremely downmodulated due to the relative quiescence of thalamic intrinsically bursting neurons. 

\textbf{Pick up here...}

This information can be used as a prediction as to what will happen next when thalamic bursting resumes and veridical sensory information serves as the input once again. 

% Importantly, during both the prediction and sensation phases, feedforward and feedback projections are constantly transmitting between lower and higher cortical areas. As previously mentioned, these projections originate and terminate predominantly in superficial layers, boosting their spike coherence to higher frequency spectra. This could potentially explain the differentially high gamma power in superficial layers compared to deep layers, and provides a compelling link between gamma oscillations and predicting specific details about the next sensory event.

When thalamic cells burst (roughly every 100 ms), information from the sensory periphery is the primary driving force for Layer 4 neurons in primary cortex. This information is relayed downstream to higher-level cortical areas via the strong feedforward Layer 4 $\rightarrow$ Layer 2/3 $\rightarrow$ Layer 4 pathway \cite{FellemanVanEssen91}. Within the local microcolumn, Layer 5 neurons integrate this information, until thalamic bursting quiets (generally around 50 ms). At this point, Layer 5 cells burst, sending outputs to Layer 6 and shifting and inputs to the microcolumn endogenously. 

In the context of Leabra's error-driven learning these two phases correspond to the plus phase (sensation) and minus phase (prediction), which can be used to compute a sensory prediction error signal. This error signal modifies Layer 5 $\rightarrow$ Layer 6 synapses to minimize differences between predictions and sensations over time.

Critically, for the LeabraTI computation to work, thalamic and Layer 5 oscillatory phases need to have an approximately antiphase relationship in order for the error-driven learning scheme described here to work so that Layer 2/3 neurons can represent the current moment's prediction with Layer 6 context as their primary input and then subsequently represent the veridical sensory input while Layer 5 neurons are queuing up the next contextual event. Such a relationship has not yet been shown yet, but very few studies have recorded simultaneously from thalamic and cortical neurons in \textit{in vivo} in the awake behaving animal. It is also possible that the brain implements error-driven learning in such a way that does not require representing predictions and sensations temporally interleaved on the same neural substrate or even that the brain accomplishes temporal integration completely without supervision, which in case thalamic gating is not required.


\section{Relation to other frameworks}
% SRN
% *  need to talk about "copy" operation and inversion of it makes an autoencoder, more consistent with bio?
% Context needs to have a "smart" representation -- this means one of two things: it can be a direct copy of the Hidden layer (as in a standard SRN), effectively borrowing all the learning that shapes the Hidden layer, or it can have its own learned representation, in which case it needs some kind of useful training signal.
% 'NOT a direct copy of the contents of the microcolumn itself but rather the sustained reflection of the net input from the broader context back to the microcolumn. Consistent with this, 6CTC guys have very broad RF's relative to their own microcolumn, and integrate information widely. The combined effects of 5b BI and 6 CC rapid depression result in a very phasic update of the 6CTC cells (on the alpha cycle). The output of the 6CTC's has strong mGluR concentrations, leading to longer-lasting effects, combined with the facilitating synaptic dynamics, resulting in the sustained delivery of this contextual netin to the rest of the microcolumn units via sustained influence on thalamus etc.
% more like a temporal autoencoder
% from ti_full: ``One particularly important difference from a standard SRN arises because of the bidirectional connectiv- ity in LeabraTI and the temporally distributed error-driven learning mechanism: we use a single input layer to represent both the expectation and outcome, interleaved across time, whereas a standard SRN has a fixed input layer feeding through the hidden layer to generate a prediction of the input at the next time step, over an entirely separate set of output units. Thus, the LeabraTI model provides a much more natural mechanism for predictive learning in the brain: the predictions are generated over the very same layers that represent the outcomes against which those predictions are compared.''
% also from ti_full ``However, this biology is more compatible with a particular rotation of the SRN-style computation (Figure 3), where the context is immediately sent through the adaptive synaptic weights that integrate this information, and what is fed back through the layer 6 thalamocortical loops is actually the pre-computed net input from the context onto a given hidden unit, not the raw context information itself. Computationally, and metabolically, this is a much more efficient mechanism, because the context is, by definition, unchanging over the 100 msec alpha cycle, and thus it makes more sense to pre-compute the synaptic integration, rather than repeatedly re-computing this same synaptic integration over and over again. Specifically, the extensive collateral connectivity among deep layer 5 neurons is what computes this synaptic integration of the context signal, as we review in the next section.''

% Predictive coding
% Has been described for single stimuli, but not temporal sequences. Still, compatible with temporal idea, but very different predictions -- need to re-read Bastos paper to determine how prediction error is manifested in super/deep layers and how it would work over time. Still, there is the standard Leabra/predictive coding difference to talk about 
% same ``delta'' signal (predicted - actual) but interleaved over time instead of a residual error  code -- different predictions, esp in terms of activation levels (see predictive remapping)

% To generate reasonable expectations, it is essential to sustain and integrate information from the past
\section{LeabraTI testable predictions}
%More generally, LeabraTI's dichotomy of continuous integration in superficial layers and periodic updating of deep layers receives strong support by the literature. Recent studies that have employed depth electrodes to simultaneously record from multiple layers within a patch of cortex have indicated that superficial layers exhibit spectral power at much higher frequencies than deep layers. \incite{BuffaloFriesLandmanEtAl11} recorded responses from ventral visual sites V1, V2, and V4 in awake, behaving monkeys during a simple directed attention task, finding a dissociation in spike coherence frequency in superficial (gamma spectrum, peak $\sim$50 Hz) and deep layers (alpha spectrum, peak $\sim$10 Hz). A similar experimental paradigm expands on these findings by demonstrating cross-frequency coupling between gamma and alpha spectra localized to superficial and deep layers, respectively \cite{SpaakBonnefondMaierEtAl12}. % say something about modulation here
%The cross-frequency coupling is characterized by a clear nesting of gamma activity within alpha cycles, suggesting that deep neurons' alpha activity might subserve a general pacemaker mechanism. In the context of LeabraTI, this pacemaker property is important to ensure the regular updating of context through deep layers and temporally predictable reintegration with more current information.
% Spaak: within the lower frequency alpha oscillations and an inverse relationship in which alpha attenuation resulted in higher amplitude and longer lasting gamma activity (and vice versa)

%This rhythmic firing has been shown to persist even with constant sensory stimulation \textit{in vivo} \cite{LuczakBarthoHarris13}, suggesting that Layer 5 neurons' alpha rhythmicity could implement a roughly 10 Hz gating function for spikes relayed to Layer 6 neurons. % get rid of gating, change to updates/periodicities
% need to talk about two types of layer 6 neurons and how one of them integrates broader context of L5 bursts -- make sure this is compatible with biology i.e., multiple L5b guys project to 1 of the broad RF L6 guys

%Thus, Layer 6 specifically becomes the neural substrate of the SRN's temporally lagged context representation, representing information that is, on average, one alpha cycle (approximately 100 ms) in the past. This contextual storage occurs at an automatic interval due to the intrinsic pacemaking properties of Layer 5 neurons, and might implement a reference frame that essentially would allow the brain to know \textit{when} to anticipate inputs. As such, intrinsic oscillations have been shown to phase lock to environmental stimulation \cite{WillBerg07,LakatosKarmosMehtaEtAl08,SchroederLakatos09,StefanicsHangyaHernadiEtAl10}, ensuring environmental events coincide with key events like Layer 5 bursts in cortex. % need to unpack this entrainment idea and motivate prediction without corruption

% short bit about general predictions regarding synchronicity between layers, latencies and how readout should be 100 ms in past, etc.
% but focus of this section will be on EEG predictions
% * Alpha entrainment, classic alpha effects -- see RFI for topics to hit
% * 	Nobre, Busch, VanRullen, Mathewson, etc.
% * 	prediction/sensation interleaving, basic evidence for this, to be tested further with my experiments
% *		Role of attention vs. prediction


\bibliographystyle{apa}
\bibliography{ccnlab}

\end{document}